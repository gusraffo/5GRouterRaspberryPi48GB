This file is part of 5GRaspi4B8GBRouter

5GRaspi4B8GBRouter is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

5GRaspi4B8GBRouter is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; 
without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with 5GRaspi4B8GBRouter. If not, see <https://www.gnu.org/licenses/>.


Written by:

Telecom's Engineer Gustavo Raffo 
Montevideo, Uruguay
gusraffo@gmail.com 
Mobile:+59899538198
5/19/2022


 
############################################################################################################################################	
Project 5G Router using Raspberry Pi 4B 8GB with LTE Advanced Pro external modem with antenas and 2 WiFi hotspots in 2.4Ghz and 5GHz 802.11ac
#############################################################################################################################################

The Raspberry  has several USB ports. This means that with extension cables you can connect up to 4 modems and also a USB stick for remote keyboard and mouse

The objective is to model a Urban/Rural 5G router, starting with a 4G Rel.8 compatible Huawei dongle, then a M.2 Huawei Cat 4 M.2 chip with external antenas. This antenas can be upgraded to two outdoor directional antenas,located outside a house or building with a pole, pointing at the mobile site sector closest to the house.

This antenas act as MIMO (Multiple Output Multiple Input) and hace to be placed at 90 degrees for spatial mutilpexing. Also one is at 45 degrees from the y axis and the other at -45 degrees.

The use of this System on a Chip (SoC) hardware has the benefit of giving great performance with very low cost in the order of 50 dollars + the cost of the
USB adaptor/ RaspiHat, external antenas, roof antenas and M.2 form factor modem chips 4.5G/5G. 

The M.2 Modem Chips have ports for antenas as well as GPS for coorinates. Depending on the 4.5G categories and vendors, they have different capabilites
and are compatible with the different 4.5G releases, from Rel.8 to Rel.13. This gives a gamma of prices to choose according to customer requirements or
the price they are able to pay. In general they should be better than Huawei 4G/WiFi routers Rel.8 that are installed in urban/rural areas.

The price of the 5G modems is still high, around US$ 300 and there is no sign that they will decrase due to global chip shortage and tensions between China/Taiwan. Taiwan has TMSC that produces the Snapdragon X55 5G sub6Ghz modems, that are used as a component for the M.2 chips of other manufactureres. 


Qualcomm Snapdragon Family
##########################

Snapdragon family has the best modems for 5G and is standarized for Global bands in FDD and TDD technologies.

There are 2 important difference with the chips:

1) One is in the range of sub6GHz, using bands from 600MHz to 2600MHz, 3500MHz band, WiFi 5GHz band (listen 
before talk functionality to co-exist with WiFi devices and APs), 6Ghz band.

2) The other is the dual operation in Sub6GHz and higher frecuency bands of 25GHz and 50GHz. This are for Long Term Evolution and are designed for other
environments where the mobile density is of thousands of devices one next to the other (Stadium, Arena, Big Capital city center, thousands of drones together)



System Description and benefits
###############################

The micro SD card that is used to develop the Linux configuration, Python software including GUI, Routing, different setups and other network configurations 
and can be cloned to have a mass scale production, given the fact that the RaspberryPi4B8GB with it peripherals is also a powerfull computer and will be provided as part of the customers solution.

The end user will have a Linux Operating System to use for connecting to the internet and work, edit video, edit audio, play games, connect hardware to the
GPIO. It's highly versatile and that's why it was chosen. 

This is a SoC micro-computer with high specifications and it's a Long Term Evolution platform. It should be upgradable in terms of software and also
as it is given as an Open Source Software it can be improved or modified by under the GNU General Public License as mentioned in the begging of this file. 

This system also gives the  possibility of remote logging into the Computer for Support issues that can be resolved remotely without sending support teams 
onsite. 

To reduce failure points only the Raspi4B8GB, the USB modem with M.2 Chip, external/roof antenas and Transformer of 5.1 Volts would be the main setup. An
optional battery can be used to give power to the system in case of power grid failure, though the system would work only as a Router and not as a PC,
because monitors are not usually connected to batteries. 

It is recommended to use heat sinks and 1 or 2 shimmer fans to keep a low temperature in the CPU, GPU and RAM for the cases of high peak of data traffic or
computer intensive applications that might run on the device.

When boot happens the computer automatically updates and upgrades packages. This is important from the kernel cyber security and application cyber security.


Cyber Security
##############

Cyber Security will be prioritized in the design as it is the greatest risk for internet connection. 

VPN connectivity with providers that protect the device IP address to the internet should be implemented whenever possible as an option and used always if it is not a problema for the internet access to sites. For example, in some cases the IP range of Uruguay is required to access sites or coporate VPN access thatuses geo-location or SMS authentication.

The ufw should be configured and activated to avoid all possible connection from the internet and only enabled manually by the user to allow access from official technical support. Connection to alarms or IP cameras is a topic that should be configured minimizing the remote IP addresses that can access the device.

If DynDns is used, it is very important to configure all the cyber security recommendations.

The same applies to apache2 web server.

All ports that are not required should be blocked and only opened manually if required, to avoid backdoors.

The passwords used in the WiFi hot-spots should be long and generated randomly including letters, capital letters, numbers and characters.


Camera
######

RaspberryPiB has a camera that can be used with the GPU to implement AI image recongition and be used to detect persons or object with great accuracy and 
might be used as an extension of the system capablities for day and night vision in the case of the Camera V2.1. 

There are infinite applications that can be added developed by the internet provider, the user or third party and included in the connected system to expand 
it's capabilities, which adds AI for Long Term Evolution.


Microphone and speakers
#######################

The Raspi has a 4-pole stereo audio with microphone option. It can be used as part of an AI system for detecting voice commands as well as play messages, music, videos, etc., just like a PC or mobile phone.


Two 4K Screen Support
#####################

The system support 2 micro HDMI cables to HDMI for monitors or TVs though only one can be used in 4K simultaneously. This gives the option to project a video in 4K while using a second monitor for PC tasks if required.

8GB RAM
*******

The 8GB RAM is future proof for supporting Raspbian GUI and heavy tasks. The 4GB or 2GB options are not recommended for Long Term Evolution. It might save
some money in the short term, but the device will not escalate in the long term, or will suffer performance issues in the OS. 


WiFi 802.11ac protocol
######################

802.11ac allows 256QAM modulation (8 bits/simbol), supports 8x160MHz (8x8MIMO) of spectral bandwidth to play with versus 4x40MHz in 802.11n. This gives 802.11ac a range of 
speeds from 433 Mbps (megabits per second) up to several Gigabits per second. 

Also 802.11ac uses beamforming that transmits radio signals in such a way that they’re directed at a specific device. This can increase overall throughput andmake it more consistent, as well as reduce power consumption. Beamforming can be done with smart antennae that physically move to track a device, or by modulating the amplitude and phase of the signals so that they destructively interfere with each other, leaving just a narrow, interference-free beam.

802.11ac does not support WPA3 Security Protocol, but strong long passwords with symbols are sufficient to have Cyber Security. This is a good reason to migrate in the near future for WiFi6 802.11ax.


WiFi6 protocol 802.11ax (not included by default in the RaspberryPi4B8GB)
#########################################################################

Though not included by default in the SoC System, all WiFi6 devices have URSEC homologation approved at this day. WiFi6E, which uses the 2.4,5 and 6GHz band
are still not approved for homologation. 

Modern Mobile Telephone Devices already have WiFi6 technology.

In the same way as the USB modem M.2 interface can be used for Mobile M.2 form factor chips, there are WiFi6 and WiFi6E M.2 form factor chips. This is 
promising as the SoC System can be upgraded using a USB port with the corresponging WiFi6/WiFi6E M.2 chip.  

So again in this aspect of connectivity it is a Long Term Evolution that is possible with the same SoC System.

The quadrupling of overall throughput is made possible by a higher spectral efficiency. The key feature underpinning 802.11ax is orthogonal frequency-divisionmultiple access (OFDMA), which is equivalent to cellular technology applied into Wi-Fi.

Other improvements on spectrum utilization (6GHz band) are better power-control methods to avoid interference with neighboring networks, higher order 1024‑QAM,up-link direction added with the down-link of MIMO and MU-MIMO to further increase throughput, as well as dependability improvements of power consumption andsecurityprotocols such as Target Wake Time and WPA3. 


WPA3 WiFi6 802.11ax Security 
############################

Pre-shared key WPA and WPA2 remain vulnerable to password cracking attacks if users rely on a weak password or passphrase. WPA passphrase hashes are seeded 
from the SSID name and its length; rainbow tables exist for the top 1,000 network SSIDs and a multitude of common passwords, requiring only a quick lookup to speed up cracking WPA-PSK.

Brute forcing of simple passwords can be attempted using the Aircrack Suite starting from the four-way authentication handshake exchanged during association 
or periodic re-authentication.

WPA3 replaces cryptographic protocols susceptible to off-line analysis with protocols that require interaction with the infrastructure for each guessed 
password, supposedly placing temporal limits on the number of guesses.However, design flaws in WPA3 enable attackers to plausibly launch brute-force 
attacks (see Dragonblood attack).

WPA3 SAE has a transition mode (sometimes called mixed mode) created to allow WPA2 clients to co-exist on the same SSID used for WPA3. Although WPA3 needs to have PMF set to Required, the STA can also set is as Enabled, so that the STA which is not compliant with either WPA3 or PMF can still connect seamlessly.

WPA3 is not availbale in 802.11ac. It is included as an option in 802.11ax 




RAspberryPi4 8GB Specifications:
################################

Broadcom BCM2711, Quad core Cortex-A72 (ARM v8) 64-bit SoC @ 1.5GHz
1GB, 2GB, 4GB or 8GB LPDDR4-3200 SDRAM (depending on model)
2.4 GHz and 5.0 GHz IEEE 802.11ac wireless, Bluetooth 5.0, BLE
Gigabit Ethernet
2 USB 3.0 ports; 2 USB 2.0 ports.
Raspberry Pi standard 40 pin GPIO header (fully backwards compatible with previous boards)
2 × micro-HDMI ports (up to 4kp60 supported)
2-lane MIPI DSI display port
2-lane MIPI CSI camera port
4-pole stereo audio and composite video port
H.265 (4kp60 decode), H264 (1080p60 decode, 1080p30 encode)
OpenGL ES 3.1, Vulkan 1.0
Micro-SD card slot for loading operating system and data storage
5V DC via USB-C connector (minimum 3A*)
5V DC via GPIO header (minimum 3A*)
Power over Ethernet (PoE) enabled (requires separate PoE HAT)
Operating temperature: 0 – 50 degrees C ambient
* A good quality 2.5A power supply can be used if downstream USB peripherals consume less than 500mA in total.



Gigabit Ethernet and USB 3.0
############################

Though there is a Gbps Ethernet interface in the Raspberry4B, there are limitations due to the cable connections and

The pi4 requires all 8 wires in a network cable to be connected. GB speed (1000Base-T) requires 4 pairs. Cat.6, Cat.6a, Cat7 cables are recommended to obtain Gbps communication.

While Raspberry Pi 3 Model B+ added Gigabit Ethernet connectivity, throughput on Raspberry Pi 4 is free from the single shared USB 2.0 channel to the SoC.” 
(https://www.raspberrypi.org/magpi/raspberry-pi-4-specs-benchmarks/)

To be more specific, the USB host controller is connected directly to the SoC via a PCIe bus. The Ethernet Controller is built directly in to the SoC.

The Ethernet port, relocated to the top-right of the board, now offers full-speed network connectivity with no bottlenecks. 

Two USB 3.0 ports, centre, offer high-speed connectivity for external devices including storage and accelerator hardware.

Two other USB 2.0 ports are situated next to the USB 3.0 ports. 

Check the folling link to see specifications and testing resutls:


Harware and OS benefits
#######################

A) The Raspberry4B8GB is a powerful CPU with 4 Cores and 1 GPU, 8GB of RAM, as well as 4 USB ports and 1Gbps Ethernet port, plus 2 WiFi antenas of 2.4Ghz and 5GHz 802.11ac, as well as Bluetooth 5.0. It has 2 4K microHDMI ports for two monitors and audio jack, as well as GPIO. 

B) Raspbian OS Bullseye is a stable 64-bit 

c) The cost of the RaspberryPi4B is in the order of 50 dollars and with some extras is a cheap and powerfull platform. This is needed to be able 
to produce high speed rates in the USB ports where the modems are connected to the 4.5G LTE Advanced Pro Rel.13 and 5G Rel.15 mobile networks.

D) The approach of using an external USB adapter with M.2 modem chips or a RaspiHat with M.2 interface gives a high versatility to change chips
easily and upgrade or replace failed components, giving a Long Term Evolution possibility on the device that will connect to the mobile network  


